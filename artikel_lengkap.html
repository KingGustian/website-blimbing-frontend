<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artikel Lengkap - Desa Blimbing</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #2c7865;
      --secondary-color: #ff9800;
      --light-gray-color: #f8f9fa;
      --text-color: #343a40;
    }

    body {
      background-color: var(--light-gray-color);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .navbar {
        background-color: var(--primary-color);
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .navbar-brand {
        font-weight: 700;
        font-size: 1.5rem !important;
    }

    .article-header {
      position: relative;
      height: 50vh;
      background-size: cover;
      background-position: center;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .article-header::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
    }

    .article-header-content {
      position: relative;
      z-index: 2;
    }
    
    .article-title-header {
        font-weight: 700;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
    }

    .article-container {
      margin-top: -80px;
      position: relative;
      z-index: 3;
    }
    
    .article-card {
        background-color: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        overflow: hidden;
    }

    .article-meta {
      color: #6c757d;
      font-size: 0.9rem;
      margin-bottom: 25px;
    }
    
    .article-meta span {
        margin-right: 15px;
    }

    .article-content {
      line-height: 1.8;
      color: var(--text-color);
      font-size: 1.1rem;
    }
    
    .article-content p {
        margin-bottom: 1.5rem;
    }

    .back-link {
      background-color: rgba(255, 255, 255, 0.9);
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 600;
      padding: 10px 20px;
      border-radius: 50px;
      transition: all 0.3s ease;
    }
    
    .back-link:hover {
      background-color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-tree me-2" style="color: var(--secondary-color);"></i>
        Desa Blimbing
      </a>
      <a href="Menu Artikel.html" class="btn btn-outline-light">Lihat Semua Artikel</a>
    </div>
  </nav>

  <header id="article-header" class="article-header">
      <div class="article-header-content">
          <a href="Menu Artikel.html" class="back-link mb-4 d-inline-block"><i class="fas fa-arrow-left me-2"></i>Kembali ke Daftar Artikel</a>
          <h1 id="article-title-header" class="display-4 article-title-header">Memuat Artikel...</h1>
      </div>
  </header>

  <div class="container article-container">
    <div class="row justify-content-center">
        <div class="col-lg-9">
            <div class="card border-0 article-card">
                <div class="card-body p-4 p-md-5">
                    <div id="article-meta" class="article-meta"></div>
                    <div id="article-content" class="article-content">
                        <p>Silakan tunggu...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
  
  <footer class="text-center py-4 mt-5">
      <p class="mb-0">&copy; 2025 Desa Blimbing. All rights reserved.</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
        // Ambil elemen-elemen HTML
        const header = document.getElementById('article-header');
        const titleHeader = document.getElementById('article-title-header');
        const metaContainer = document.getElementById('article-meta');
        const contentContainer = document.getElementById('article-content');
        
        // Atur tampilan default jika terjadi error
        const showError = (message = 'Artikel yang Anda cari tidak tersedia.') => {
            titleHeader.textContent = 'Artikel Tidak Ditemukan';
            contentContainer.innerHTML = `<p class="text-center text-danger">${message}</p>`;
            header.style.backgroundColor = '#6c757d'; // Warna fallback
            metaContainer.innerHTML = '';
        };

        try {
            // 1. Dapatkan ID artikel dari URL
            const urlParams = new URLSearchParams(window.location.search);
            const articleId = urlParams.get('id');

            if (!articleId) {
                throw new Error('ID artikel tidak ditemukan di URL.');
            }

            // 2. Buat URL API dan lakukan fetch
            const apiUrl = `https://website-blimbing-backend.onrender.com/api/articles/${articleId}`;
            const response = await fetch(apiUrl);

            if (!response.ok) {
                 if(response.status === 404) {
                    throw new Error('Maaf, artikel dengan ID ini tidak dapat ditemukan.');
                }
                throw new Error('Gagal mengambil data artikel dari server.');
            }

            const article = await response.json();

            // 3. Ubah format tanggal
            const creationDate = new Date(article.createdAt).toLocaleDateString('id-ID', {
                day: 'numeric', month: 'long', year: 'numeric'
            });

            // 4. Masukkan data dari API ke dalam elemen HTML
            header.style.backgroundImage = `url('${article.image}')`;
            titleHeader.textContent = article.title;
            metaContainer.innerHTML = `
                <span><i class="fas fa-user me-2"></i>${article.author}</span>
                <span><i class="far fa-calendar-alt me-2"></i>${creationDate}</span>
                <span><i class="fas fa-tag me-2"></i>${article.category}</span>
            `;
            // Mengubah newline (\n) menjadi tag <p> untuk format paragraf yang lebih baik
            const formattedContent = article.content.split('\\n').map(p => `<p>${p}</p>`).join('');
            contentContainer.innerHTML = formattedContent;

        } catch (error) {
            console.error('Error fetching article:', error);
            showError(error.message);
        }
    });
  </script>
</body>

</html>